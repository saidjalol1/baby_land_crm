{% extends "wrapper.html" %}
{% load static %}
{% block title %}Statistika{% endblock title %}
{% block content %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<div class="pagetitle">
  <h1>Statistika</h1>
</div><!-- End Page Title -->

<section class="section dashboard">
  <div class="row">
    <!-- Your JavaScript code here --><!-- End Left side columns -->
    <div class="col-lg-12">
      <div class="row">
        <!-- Sales Card -->
        <div class="col-xxl-3 col-md-6">
          <div class="card info-card sales-card">
            <div class="card-body">
              <h5 class="card-title">Sotuv <span>| Shu oyda</span></h5>

              <div class="d-flex align-items-center">
                <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                  <i class="bi bi-cart"></i>
                </div>
                <div class="ps-3">
                  <h6>{{ sale_month }} so'm</h6>
                </div>
              </div>
            </div>

          </div>
        </div><!-- End Sales Card -->

        <!-- Revenue Card -->
        <div class="col-xxl-3 col-md-6">
          <div class="card info-card revenue-card">
            <div class="card-body">
              <h5 class="card-title">Foyda <span>| Shu oyda</span></h5>

              <div class="d-flex align-items-center">
                <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                  <i class="bi bi-currency-dollar"></i>
                </div>
                <div class="ps-3">
                  <h6>{{ income_month }} so'm</h6>
                </div>
              </div>
            </div>

          </div>
        </div><!-- End Revenue Card -->

        <div class="col-xxl-3 col-md-6">

          <div class="card info-card customers-card">
            <div class="card-body">
              <h5 class="card-title">Eng Ko'p sotilgan Mahsulot <span>| Shu oyda</span></h5>

              <div class="d-flex align-items-center">
                <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                  <i class="bi bi-box-fill"></i>
                </div>
                <div class="ps-3">
                  <h6>{{ most_sold_product }}</h6>
                </div>
              </div>

            </div>
          </div>

        </div>
        <!-- Customers Card -->
        <div class="col-xxl-3 col-md-6">

          <div class="card info-card customers-card">
            <div class="card-body">
              <h5 class="card-title">Eng Ko'p xarid qilgan mijoz <span>| Shu oyda</span></h5>

              <div class="d-flex align-items-center">
                <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                  <i class="bi bi-people"></i>
                </div>
                <div class="ps-3">
                  <h6>{{ most_bought_shop }}</h6>
                </div>
              </div>

            </div>
          </div>

        </div><!-- End Customers Card -->
      </div>
      <div class="row">
          <div class="col-xxl-12 card">
            <div id="salesChartContainer" height="200px">
              <canvas id="monthlySalesChart" width="700" height="200"></canvas>
              <script>
                const monthNames = {{ month_names|safe }};
                const sales = {{ sales|safe }};
              
                const monthlySalesChart = document.getElementById('monthlySalesChart').getContext('2d');
                const chart = new Chart(monthlySalesChart, {
                    type: 'bar', // Bar chart
                    data: {
                        labels: monthNames,
                        datasets: [{
                            label: 'Sales Quantity',
                            data: sales,
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
              </script>
            </div>
          </div>
      </div>
      
    </div>
  </div>
</section>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

{% endblock content %}